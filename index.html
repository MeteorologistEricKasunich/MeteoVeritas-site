<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MeteoVeritas – Weather Intelligence</title>
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <header>
    <h1>MeteoVeritas</h1>
    <nav>
      <a href="/">Home</a>
      <a href="/wbgt.html">WBGT Center</a>
      <a href="/historical.html">Research</a>
      <a href="/consulting.html">Consulting</a>
      <a href="/contact.html">Contact</a>
    </nav>
  </header>

  <main>
    <section id="intro">
      <h2>Your Source for Verified Weather Insight</h2>
      <p>Scientific. Accurate. Trusted.</p>
    </section>

    <!-- Weather News Section -->
    <section id="weather-news" style="margin: 40px auto; max-width: 1100px;">
      <h2 style="font-size: 1.8em; color: #003366; margin-bottom: 20px;">Today’s Weather News</h2>
      <div id="news-container" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px;"></div>
      <button id="more-news-btn" class="mv-btn-primary" style="margin-top: 20px;">Get More Weather News</button>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 MeteoVeritas. All rights reserved.</p>
  </footer>

  <!-- Weather News Script -->
  <script>
    const rssFeeds = [
      "https://www.weather.gov/rss_page_updates.php",
      "https://rss.accuweather.com/rss/liveweather_rss.asp?metric=0",
      "https://www.foxweather.com/rss",
      "https://www.noaa.gov/news/rss.xml"
    ];

    const proxy = "https://api.allorigins.win/get?url=";

    async function fetchWeatherNews() {
      const newsContainer = document.getElementById("news-container");
      newsContainer.innerHTML = "";

      const articles = [];

      for (const feedUrl of rssFeeds) {
        try {
          const res = await fetch(proxy + encodeURIComponent(feedUrl));
          const data = await res.json();
          const parser = new DOMParser();
          const xml = parser.parseFromString(data.contents, "text/xml");
          const items = xml.querySelectorAll("item");

          items.forEach((item) => {
            if (articles.length < 20) {
              articles.push({
                title: item.querySelector("title")?.textContent,
                link: item.querySelector("link")?.textContent,
                description: item.querySelector("description")?.textContent?.substring(0, 140) + "...",
                pubDate: item.querySelector("pubDate")?.textContent,
                thumbnail: item.querySelector("media\\:thumbnail, thumbnail")?.getAttribute("url") || "https://www.weather.gov/themes/custom/nws/images/nws-social-share.png"
              });
            }
          });
        } catch (err) {
          console.error("Failed to load feed:", feedUrl, err);
        }
      }

      renderArticles(articles.slice(0, 5));

      document.getElementById("more-news-btn").onclick = () => {
        renderArticles(articles);
        document.getElementById("more-news-btn").style.display = "none";
      };
    }

    function renderArticles(articles) {
      const container = document.getElementById("news-container");
      container.innerHTML = "";

      articles.forEach(article => {
        const div = document.createElement("div");
        div.style.border = "1px solid #ccc";
        div.style.borderRadius = "8px";
        div.style.overflow = "hidden";
        div.style.backgroundColor = "white";
        div.style.boxShadow = "0 2px 8px rgba(0,0,0,0.05)";
        div.style.transition = "transform 0.3s ease";

        div.onmouseover = () => div.style.transform = "scale(1.02)";
        div.onmouseout = () => div.style.transform = "scale(1)";

        div.innerHTML = `
          <a href="${article.link}" target="_blank" style="text-decoration: none; color: inherit;">
            <img src="${article.thumbnail}" alt="thumbnail" style="width:100%; height:160px; object-fit:cover;">
            <div style="padding: 10px;">
              <h3 style="font-size: 1em; margin-bottom: 8px; color: #003366;">${article.title}</h3>
              <p style="font-size: 0.9em; color: #555;">${article.description}</p>
              <p style="font-size: 0.8em; color: #999;">${new Date(article.pubDate).toLocaleDateString()}</p>
            </div>
          </a>
        `;
        container.appendChild(div);
      });
    }

    fetchWeatherNews();
  </script>
</body>
</html>
